---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytuesdayR)
library(skimr)
```

```{r}
tuesdata <- tt_load(2021, week = 21)

survey <- tuesdata$survey
```

## cleaning country

```{r}
survey_clean <- survey %>% 
  mutate(
    country_clean = case_when(
      country %in% c("United States", "USA", "US", "U.S.", "United States of America", "Usa", "United states", "usa", "Us", "united states", "U.S.A.", "us", "U.S", "United State", "Unites States", "United States of america", "UNITED STATES", "The United States", "United Sates") ~ "United States",
      country %in% c("United Kingdom", "UK", "Uk", "United kingdom", "uk", "united kingdom") ~ "United Kingdom",
      T ~ country
    )
  )
```

would be cool to write a function that makes all of this a whole lot easier


```{r}
# binary string generator

binary_strings <- function(n, digits = c('0','1')) {
  if (n <= 0) return(matrix(0,0,0))
  if (n == 1) return(matrix(digits, 2))
  x <- binary_strings(n - 1)
  rbind(cbind(digits[1], x), cbind(digits[2], x))
}


name_variety <- function(name) {
  
  # separate string into its individual words
  
  words <- str_to_lower(str_split(name, " ")[[1]])
  
  # create bistrings
  
  n <- length(words)
  
  binary_tibble <- as_tibble(binary_strings(n))
  
  # create placeholder tibbles to be filled with modified strings
  
  full_word_cap <- binary_tibble
  first_letter_cap <- binary_tibble
  
  for (row in 1:nrow(binary_tibble)) {
     for (col in 1:n) {
      if (binary_tibble[row, col] == '0') {
        first_letter_cap[row, col] <- words[col]
        full_word_cap[row, col] <- words[col]
      } else {
        first_letter_cap[row, col] <- paste0(str_to_upper(str_sub(words[col], 1, 1)), str_sub(words[col], 2, -1))
        full_word_cap[row, col] <- str_to_upper(words[col])
      }

     }
  }
  
  # right now each word is a different column so we'd like to the unite the columns with a space as the seperator
  
  first_letter_cap <- unite(first_letter_cap, phrase, 1:ncol(first_letter_cap), sep = " ")
  full_word_cap <- unite(full_word_cap, phrase, 1:ncol(full_word_cap), sep = " ")
  
  # remove any duplicates
  
  final_phrases <- rbind(first_letter_cap, full_word_cap) %>% 
    distinct(.keep_all = T)
  
  # turn our dataframe into a vector where each object is a string
  
  unlist(final_phrases, use.names = F)
  
}



```

Things to check for:

First letter capitalization: Yo Yo, yo Yo, Yo yo, yo yo
entire word capitalization: YO YO, yo yo, YO yo, yo YO











